server:
  port: ${SERVER_PORT:9999}
  address: ${SERVER_ADDRESS:0.0.0.0}

spring:
  main:
    banner-mode: "off"
  application:
    name: unidbg-boot-server
  mvc:
    async:
      request-timeout: 120000
  task:
    execution:
      pool:
        allow-core-thread-timeout: true
        core-size: 8
        keep-alive: 60s
        max-size: 8

logging:
  pattern:
    console: "%d{HH:mm:ss} %-5level %logger{36} - %msg%n"
  level:
    root: INFO
    org.springframework.boot.StartupInfoLogger: OFF
    org.springframework.boot.web.embedded.tomcat: WARN
    org.springframework.boot.web.servlet.context: WARN
    org.springframework.web.servlet.DispatcherServlet: WARN

application:
  unidbg:
    dynarmic: false
    verbose: false
    async: false
    # 默认使用内置 APK（classpath）：com/dragon/read/oversea/gp/apk/base.apk
    # 需要替换 APK：把新 APK 放到 src/main/resources/com/dragon/read/oversea/gp/apk/base.apk 即可
    #
    # 或者覆盖为本地文件路径（优先级更高）：
    # apk-path: /abs/path/to/base.apk
    #
    # 或者显式指定 classpath 资源路径：
    # apk-classpath: com/dragon/read/oversea/gp/apk/base.apk

fq:
  download:
    request-interval-ms: 500
    max-retries: 3
    retry-delay-ms: 1500
    retry-max-delay-ms: 10000
    # 上游 HTTP 超时（避免 RestTemplate 默认“无超时”导致线程卡死）
    upstream-connect-timeout-ms: 8000
    upstream-read-timeout-ms: 15000
    # 连续异常达到阈值后，进程会自动退出（依赖 Docker/systemd 拉起）
    auto-restart-enabled: true
    auto-restart-error-threshold: 3
    auto-restart-window-ms: 300000
    auto-restart-min-interval-ms: 60000
    auto-restart-force-halt-after-ms: 10000
  api:
    base-url: https://api5-normal-sinfonlineb.fqnovel.com

    # 默认设备配置（无 device-pool 时使用）
    user-agent: com.dragon.read.oversea.gp/68132 (Linux; U; Android 13; zh_CN; WLZ-AN00;
      Build/V433IR;tt-ok/3.12.13.4-tiktok)
    cookie: store-region=cn-zj; store-region-src=did; install_id=670078579016233;
    device:
      aid: '1967'
      cdid: 5566b484-82f9-4cef-880d-60ca354e6a99
      device-brand: HUAWEI
      device-id: '670078578733609'
      device-type: WLZ-AN00
      dpi: '480'
      host-abi: arm64-v8a
      install-id: '670078579016233'
      resolution: 1920*1080
      rom-version: V433IR+release-keys
      update-version-code: '68132'
      version-code: '68132'
      version-name: 6.8.1.32
      os-version: '13'
      os-api: '32'

    # 设备池（风控时切换）：启动时会随机选一个作为当前设备；只使用前 3 个；切换冷却 30s
    device-pool-size: 3
    device-pool-shuffle-on-startup: true
    # 启动随机但做一次“轻量探测”：跳过启动就风控/空响应的设备（例如 SEARCH_NO_SEARCH_ID）
    device-pool-probe-on-startup: true
    device-pool-probe-max-attempts: 3
    device-rotate-cooldown-ms: 30000
    device-pool:
      - name: dev001
        user-agent: com.dragon.read.oversea.gp/68132 (Linux; U; Android 13; zh_CN; WLZ-AN00;
          Build/V433IR;tt-ok/3.12.13.4-tiktok)
        cookie: store-region=cn-zj; store-region-src=did; install_id=670078579016233;
        device:
          aid: '1967'
          cdid: 5566b484-82f9-4cef-880d-60ca354e6a99
          device-brand: HUAWEI
          device-id: '670078578733609'
          device-type: WLZ-AN00
          dpi: '480'
          host-abi: arm64-v8a
          install-id: '670078579016233'
          resolution: 1920*1080
          rom-version: V433IR+release-keys
          update-version-code: '68132'
          version-code: '68132'
          version-name: 6.8.1.32
          os-version: '13'
          os-api: '32'
      - name: dev002
        user-agent: com.dragon.read.oversea.gp/68132 (Linux; U; Android 13; zh_CN; nova10;
          Build/V433IR;tt-ok/3.12.13.4-tiktok)
        cookie: store-region=cn-zj; store-region-src=did; install_id=2223059664204628;
        device:
          aid: '1967'
          cdid: e95f6d69-ab28-454b-b125-f187bb73a4d9
          device-brand: HUAWEI
          device-id: '1149855321344089'
          device-type: nova10
          dpi: '640'
          host-abi: arm64-v8a
          install-id: '2223059664204628'
          resolution: 3200*1440
          rom-version: V433IR+release-keys
          update-version-code: '68132'
          version-code: '68132'
          version-name: 6.8.1.32
          os-version: '13'
          os-api: '33'
      - name: dev003
        user-agent: com.dragon.read.oversea.gp/68132 (Linux; U; Android 10; zh_CN; OnePlus10;
          Build/V291IR;tt-ok/3.12.13.4-tiktok)
        cookie: store-region=cn-zj; store-region-src=did; install_id=3320676978521931;
        device:
          aid: '1967'
          cdid: 3fd40c76-e207-4be5-bb2f-3b20fb5a805e
          device-brand: OnePlus
          device-id: '4774996543971246'
          device-type: OnePlus10
          dpi: '480'
          host-abi: arm64-v8a
          install-id: '3320676978521931'
          resolution: 2400*1080
          rom-version: V291IR+release-keys
          update-version-code: '68132'
          version-code: '68132'
          version-name: 6.8.1.32
          os-version: '10'
          os-api: '29'
